<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Using roughtime as a "cryptographic notary" | Mero's Blog</title><meta name=keywords content="crypto,golang,programming"><meta name=description content="Roughtime can be (ab)used for Trusted Timestamping. I wrote a simple tool as a PoC"><meta name=author content><link rel=canonical href=https://blog.merovius.de/posts/2018-10-10-using-roughtime-as-a-cryptographic-notary/><link crossorigin=anonymous href=/assets/css/stylesheet.min.48a18943c2fc15c38a372b8dde1f5e5dc0bc64fa6cb90f5a817d2f8c76b7f3ae.css integrity="sha256-SKGJQ8L8FcOKNyuN3h9eXcC8ZPpsuQ9agX0vjHa3864=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.merovius.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.merovius.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.merovius.de/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.merovius.de/apple-touch-icon.png><link rel=mask-icon href=https://blog.merovius.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Using roughtime as a &#34;cryptographic notary&#34;"><meta property="og:description" content="Roughtime can be (ab)used for Trusted Timestamping. I wrote a simple tool as a PoC"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.merovius.de/posts/2018-10-10-using-roughtime-as-a-cryptographic-notary/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-10-10T23:22:40+00:00"><meta property="article:modified_time" content="2018-10-10T23:22:40+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Using roughtime as a &#34;cryptographic notary&#34;"><meta name=twitter:description content="Roughtime can be (ab)used for Trusted Timestamping. I wrote a simple tool as a PoC"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.merovius.de/posts/"},{"@type":"ListItem","position":2,"name":"Using roughtime as a \"cryptographic notary\"","item":"https://blog.merovius.de/posts/2018-10-10-using-roughtime-as-a-cryptographic-notary/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Using roughtime as a \"cryptographic notary\"","name":"Using roughtime as a \u0022cryptographic notary\u0022","description":"Roughtime can be (ab)used for Trusted Timestamping. I wrote a simple tool as a PoC","keywords":["crypto","golang","programming"],"articleBody":"tl;dr: Roughtime can be (ab)used for Trusted Timestamping. I wrote a simple tool as a PoC\nRecently, Cloudflare announced that they are now running a roughtime server. Roughtime is a cryptographically secured time-synchronization protocol - think NTP with signatures. For an actual description of how it works, I recommend reading the Cloudflare blog post. But at it’s very core (oversimplification ahead), the user chooses an arbitrary (usually randomly generated) nonce and the server signs it, plus the current time.\nOne thing roughtime adds on top of this, is the ability to build a chain of requests. This is achieved by taking a hash of a response, combining it with a randomly generated “blind” and using the combined hash as a nonce to the next request. The intended use-case of this is that if a server provides the wrong time or otherwise misbehaves, you can obtain cryptographic proof of that fact by getting a timestamped signature of its response from a different server. By storing the initial nonce, generated blinds and responses, the entire chain can be validated later.\nWhen I saw Cloudflares announcement, my first thought was that it should be possible to use a roughtime server as a Time Stamping Authority. The goal is, to obtain a cryptographic proof, that you owned a particular document at the current point in time - for example to ensure you can proof original authorship without publishing the document itself.\nThe simplest way to achieve this using roughtime is to use the SHA512 hash of the file as an initial nonce. That way, the roughtime server signs that hash together with the current time with their private key. By using the roughtime chain protocol, you can get that proof corroborated by multiple servers.\nYou can also think of extending this, to get stronger properties. Using the hash of the file as a nonce only proves that the file existed before that specific point in time. It also doesn’t actually prove that you had the file, but only the hash. This can be remediated though. If we run a regular roughtime request, the resulting response is unpredictable (to us) and signs the current time. Thus, if we use a hash of that response as a prefix “salt” of the file itself, the resulting hash proofs that we knew the file after that chain ran. We can then use that hash as a nonce for another roughtime chain and get a proof that we had the file at a specific point (or rather, a small interval) in time. Furthermore, we can opt to use the file-hash not as the nonce itself, but as a blind. The advantage is, that the blind is never transmitted over the network, so the actual proof is only available to us (if we use it as a nonce, an eavesdropper could intercept the proof). I illustrated these options in a recent talk I gave on the subject.\nThese ideas are mostly academic. I’m not sure how useful these properties are in practice. Nevertheless, the idea intriguiged me enough to implement it in a simple tool. It’s in a pretty rough, proof-of-concept like shape and I don’t know if I will ever progress it from there. It also comes with a client implementation of the roughtime protocol in Go - initially I was not aware that there already was a Go implementation, but that also is not go-gettable. Either way, it was fun to implement it myself :)\n","wordCount":"577","inLanguage":"en","datePublished":"2018-10-10T23:22:40Z","dateModified":"2018-10-10T23:22:40Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.merovius.de/posts/2018-10-10-using-roughtime-as-a-cryptographic-notary/"},"publisher":{"@type":"Organization","name":"Mero's Blog","logo":{"@type":"ImageObject","url":"https://blog.merovius.de/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.merovius.de/ accesskey=h title="Mero's Blog (Alt + H)">Mero's Blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Using roughtime as a "cryptographic notary"</h1><div class=post-meta><span title="2018-10-10 23:22:40 +0000 UTC">October 10, 2018</span></div></header><div class=post-content><p><strong>tl;dr: Roughtime can be (ab)used for <a href=https://en.wikipedia.org/wiki/Trusted_timestamping#Trusted_(digital)_timestamping>Trusted Timestamping</a>. I wrote a
<a href=https://github.com/Merovius/notary>simple tool</a> as a PoC</strong></p><p>Recently, <a href=https://blog.cloudflare.com/roughtime/>Cloudflare announced</a> that they are now running a
<a href=https://roughtime.googlesource.com/roughtime/>roughtime</a> server. Roughtime is a cryptographically secured
time-synchronization protocol - think NTP with signatures. For an actual
description of how it works, I recommend reading the Cloudflare blog post. But
at it&rsquo;s very core (oversimplification ahead), the user chooses an arbitrary
(usually randomly generated) nonce and the server signs it, plus the current
time.</p><p>One thing roughtime adds on top of this, is the ability to build a chain of
requests. This is achieved by taking a hash of a response, combining it with a
randomly generated &ldquo;blind&rdquo; and using the combined hash as a nonce to the next
request. The intended use-case of this is that if a server provides the wrong
time or otherwise misbehaves, you can obtain cryptographic proof of that fact
by getting a timestamped signature of its response from a different server. By
storing the initial nonce, generated blinds and responses, the entire chain can
be validated later.</p><p>When I saw Cloudflares announcement, my first thought was that it should be
possible to use a roughtime server as a <a href=https://en.wikipedia.org/wiki/Trusted_timestamping#Trusted_(digital)_timestamping>Time Stamping Authority</a>. The
goal is, to obtain a cryptographic proof, that you owned a particular document
at the current point in time - for example to ensure you can proof original
authorship without publishing the document itself.</p><p>The simplest way to achieve this using roughtime is to use the SHA512 hash of
the file as an initial nonce. That way, the roughtime server signs that hash
together with the current time with their private key. By using the roughtime
chain protocol, you can get that proof corroborated by multiple servers.</p><p>You can also think of extending this, to get stronger properties. Using the
hash of the file as a nonce only proves that the file existed <em>before</em> that
specific point in time. It also doesn&rsquo;t actually prove that you had the file,
but only the hash. This can be remediated though. If we run a regular roughtime
request, the resulting response is unpredictable (to us) and signs the current
time. Thus, if we use a hash of that response as a prefix &ldquo;salt&rdquo; of the file
itself, the resulting hash proofs that we knew the file <em>after</em> that chain
ran. We can then use that hash as a nonce for another roughtime chain and get a
proof that we had the file at a specific point (or rather, a small interval) in
time. Furthermore, we can opt to use the file-hash not as the nonce itself, but
as a blind. The advantage is, that the blind is never transmitted over the
network, so the actual proof is only available to us (if we use it as a nonce,
an eavesdropper could intercept the proof). I illustrated these options in a
<a href="https://docs.google.com/presentation/d/1quTJfXHvBZCjKJgL6HjUFb_jhDF-PghBwm_lTFLAjdg/edit#slide=id.g43c753f2a5_1_542">recent talk</a> I gave on the subject.</p><p>These ideas are mostly academic. I&rsquo;m not sure how useful these properties are
in practice. Nevertheless, the idea intriguiged me enough to <a href=https://github.com/Merovius/notary>implement it</a>
in a simple tool. It&rsquo;s in a pretty rough, proof-of-concept like shape and I
don&rsquo;t know if I will ever progress it from there. It also comes with a client
implementation of the roughtime protocol in Go - initially I was not aware that
there already was a Go implementation, but that also is not go-gettable. Either
way, it was fun to implement it myself :)</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.merovius.de/tags/crypto/>crypto</a></li><li><a href=https://blog.merovius.de/tags/golang/>golang</a></li><li><a href=https://blog.merovius.de/tags/programming/>programming</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://blog.merovius.de/>Mero's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>